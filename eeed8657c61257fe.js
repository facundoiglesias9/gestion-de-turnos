(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,86428,e=>{"use strict";var t=e.i(43476),s=e.i(71645),a=e.i(32341),r=e.i(7471);function l(){let{user:e,loading:l}=(0,a.useAuth)(),[i,o]=(0,s.useState)([]),[d,n]=(0,s.useState)([]),[c,x]=(0,s.useState)(0),[m,h]=(0,s.useState)(!0),[p,u]=(0,s.useState)(!1),[g,b]=(0,s.useState)(""),[j,f]=(0,s.useState)("");(0,s.useEffect)(()=>{e&&N()},[e]);let N=async()=>{if(!e)return;h(!0);let{data:t,error:s}=await r.supabase.from("turns").select("*").eq("user_id",e.id).eq("completed",!0).eq("paid",!0).order("date_time",{ascending:!1});s?console.error("Error loading turns:",s):t&&(n(t),x(t.reduce((e,t)=>e+(t.estimated_price||0),0)));let{data:a,error:l}=await r.supabase.from("expenses").select("*").eq("user_id",e.id).order("created_at",{ascending:!1});l?console.error("Error loading expenses:",l):a&&o(a),h(!1)},w=e=>`$${e.toLocaleString("es-AR",{minimumFractionDigits:2,maximumFractionDigits:2})}`,v=async t=>{if(t.preventDefault(),!e||!g||!j)return;let{error:s}=await r.supabase.from("expenses").insert({user_id:e.id,description:g.trim(),amount:parseFloat(j)});s?(console.error("Error adding expense:",s),alert("Error al agregar el gasto")):(C(),N())},y=async e=>{if(!window.confirm("¿Estás seguro de eliminar este gasto?"))return;let{error:t}=await r.supabase.from("expenses").delete().eq("id",e);t?(console.error("Error deleting expense:",t),alert("Error al eliminar el gasto")):N()},k=async e=>{if(!window.confirm("¿Estás seguro de eliminar este trabajo completado? Se eliminará permanentemente."))return;let{error:t}=await r.supabase.from("turns").delete().eq("id",e);t?(console.error("Error deleting turn:",t),alert("Error al eliminar el trabajo")):N()},C=()=>{u(!1),b(""),f("")},E=i.reduce((e,t)=>e+t.amount,0);return l||!e?null:(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-white",children:"Ganancias y Gastos"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,t.jsxs)("div",{className:"bg-gradient-to-br from-green-500 to-green-600 rounded-lg p-6 text-white shadow-lg",children:[(0,t.jsx)("h3",{className:"text-sm font-medium opacity-90 mb-2",children:"Ganancias Totales"}),(0,t.jsx)("p",{className:"text-3xl font-bold",children:w(c)})]}),(0,t.jsxs)("div",{className:"bg-gradient-to-br from-red-500 to-red-600 rounded-lg p-6 text-white shadow-lg",children:[(0,t.jsx)("h3",{className:"text-sm font-medium opacity-90 mb-2",children:"Gastos Totales"}),(0,t.jsx)("p",{className:"text-3xl font-bold",children:w(E)})]}),(0,t.jsxs)("div",{className:"bg-gradient-to-br from-blue-500 to-blue-600 rounded-lg p-6 text-white shadow-lg",children:[(0,t.jsx)("h3",{className:"text-sm font-medium opacity-90 mb-2",children:"Caja"}),(0,t.jsx)("p",{className:"text-3xl font-bold",children:w(c-E)})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-xl font-bold text-white mb-4",children:"Trabajos Completados"}),m?(0,t.jsx)("p",{className:"text-slate-400",children:"Cargando..."}):0===d.length?(0,t.jsx)("div",{className:"text-center py-12 glass-card",children:(0,t.jsx)("p",{className:"text-slate-400",children:"No hay trabajos completados"})}):(0,t.jsx)("div",{className:"glass-card max-h-96 overflow-y-auto overflow-x-auto",children:(0,t.jsxs)("table",{className:"w-full min-w-[500px]",children:[(0,t.jsx)("thead",{className:"bg-slate-800/50 border-b border-slate-700 sticky top-0",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"px-4 py-3 text-left text-sm font-semibold text-slate-300",children:"Cliente"}),(0,t.jsx)("th",{className:"px-4 py-3 text-left text-sm font-semibold text-slate-300",children:"Fecha"}),(0,t.jsx)("th",{className:"px-4 py-3 text-right text-sm font-semibold text-slate-300",children:"Monto"}),(0,t.jsx)("th",{className:"px-4 py-3 text-right text-sm font-semibold text-slate-300"})]})}),(0,t.jsx)("tbody",{className:"divide-y divide-slate-700",children:d.map(e=>(0,t.jsxs)("tr",{className:"hover:bg-slate-700/30 transition-colors",children:[(0,t.jsx)("td",{className:"px-4 py-3 text-slate-200 font-medium",children:e.client_name}),(0,t.jsx)("td",{className:"px-4 py-3 text-slate-400 text-sm",children:new Date(e.date_time).toLocaleDateString("es-AR")}),(0,t.jsx)("td",{className:"px-4 py-3 text-right font-medium text-green-400",children:w(e.estimated_price)}),(0,t.jsx)("td",{className:"px-4 py-3 text-right",children:(0,t.jsx)("button",{onClick:()=>k(e.id),className:"p-2 bg-red-500/20 hover:bg-red-500/40 text-red-400 rounded-lg transition-colors",title:"Eliminar",children:(0,t.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-4 h-4",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0"})})})})]},e.id))})]})})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,t.jsx)("h3",{className:"text-xl font-bold text-white",children:"Gastos"}),(0,t.jsx)("button",{onClick:()=>u(!0),className:"px-4 py-2 bg-red-500 hover:bg-red-600 text-white rounded-lg transition-colors font-medium",children:"+ Agregar Gasto"})]}),m?(0,t.jsx)("p",{className:"text-slate-400",children:"Cargando..."}):0===i.length?(0,t.jsx)("div",{className:"text-center py-12 glass-card",children:(0,t.jsx)("p",{className:"text-slate-400",children:"No hay gastos registrados"})}):(0,t.jsx)("div",{className:"glass-card max-h-96 overflow-y-auto overflow-x-auto",children:(0,t.jsxs)("table",{className:"w-full min-w-[500px]",children:[(0,t.jsx)("thead",{className:"bg-slate-800/50 border-b border-slate-700 sticky top-0",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"px-4 py-3 text-left text-sm font-semibold text-slate-300",children:"Descripción"}),(0,t.jsx)("th",{className:"px-4 py-3 text-left text-sm font-semibold text-slate-300",children:"Fecha"}),(0,t.jsx)("th",{className:"px-4 py-3 text-right text-sm font-semibold text-slate-300",children:"Monto"}),(0,t.jsx)("th",{className:"px-4 py-3 text-right text-sm font-semibold text-slate-300"})]})}),(0,t.jsx)("tbody",{className:"divide-y divide-slate-700",children:i.map(e=>(0,t.jsxs)("tr",{className:"hover:bg-slate-700/30 transition-colors",children:[(0,t.jsx)("td",{className:"px-4 py-3 text-slate-200",children:e.description}),(0,t.jsx)("td",{className:"px-4 py-3 text-slate-400 text-sm",children:new Date(e.created_at).toLocaleDateString("es-AR")}),(0,t.jsx)("td",{className:"px-4 py-3 text-right font-medium text-white",children:w(e.amount)}),(0,t.jsx)("td",{className:"px-4 py-3 text-right",children:(0,t.jsx)("button",{onClick:()=>y(e.id),className:"p-2 bg-red-500/20 hover:bg-red-500/40 text-red-400 rounded-lg transition-colors",title:"Eliminar",children:(0,t.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-4 h-4",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0"})})})})]},e.id))})]})})]})]}),p&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 backdrop-blur-sm",children:(0,t.jsxs)("div",{className:"bg-slate-800 border border-slate-700 rounded-2xl p-6 w-full max-w-md shadow-2xl",children:[(0,t.jsx)("h3",{className:"text-xl font-bold text-white mb-4",children:"Agregar Gasto"}),(0,t.jsxs)("form",{onSubmit:v,className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Descripción"}),(0,t.jsx)("input",{type:"text",value:g,onChange:e=>b(e.target.value),className:"w-full px-3 py-2 bg-slate-900 border border-slate-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 text-white",placeholder:"Ej: Compra de materiales",required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Monto"}),(0,t.jsx)("input",{type:"number",step:"0.01",min:"0",value:j,onChange:e=>f(e.target.value),className:"w-full px-3 py-2 bg-slate-900 border border-slate-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 text-white",placeholder:"0.00",required:!0})]}),(0,t.jsxs)("div",{className:"flex gap-3 pt-2",children:[(0,t.jsx)("button",{type:"button",onClick:C,className:"flex-1 px-4 py-2 border border-slate-600 text-slate-300 rounded-lg hover:bg-slate-700 transition-colors",children:"Cancelar"}),(0,t.jsx)("button",{type:"submit",className:"flex-1 px-4 py-2 bg-red-600 hover:bg-red-500 text-white rounded-lg transition-colors font-bold",children:"Agregar"})]})]})]})})]})}e.s(["default",()=>l])}]);