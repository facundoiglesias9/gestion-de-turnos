(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,72906,e=>{"use strict";var s=e.i(43476),t=e.i(71645),a=e.i(32341),l=e.i(7471),r=e.i(18566);function i(){let{user:e,loading:i}=(0,a.useAuth)(),n=(0,r.useRouter)(),[o,c]=(0,t.useState)([]),[d,x]=(0,t.useState)(null),[m,h]=(0,t.useState)([]),[p,u]=(0,t.useState)(!1),[j,g]=(0,t.useState)("users"),[N,b]=(0,t.useState)([]);(0,t.useEffect)(()=>{if(!i){if(!e||"facundo"!==e.username)return void n.push("/");f(),v()}},[e,i,n]);let f=async()=>{let{data:e,error:s}=await l.supabase.from("profiles").select("*");e&&c(e),s&&console.error("Error loading profiles:",s)},v=async()=>{let{data:e,error:s}=await l.supabase.from("app_logs").select("*").order("created_at",{ascending:!1}).limit(50);e&&b(e),s&&console.error("Error loading logs:",s)},w=async e=>{u(!0),x(e);let{data:s,error:t}=await l.supabase.from("turns").select("*").eq("user_id",e).order("date_time",{ascending:!1});s&&h(s),t&&console.error("Error loading turns:",t),u(!1)},y=async(e,s)=>{if(confirm(`\xbfEst\xe1s seguro de que quieres ELIMINAR DEFINITIVAMENTE a "${s}"? Esta acci\xf3n no se puede deshacer.`))try{let s=await fetch("/api/admin/delete-user",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:e,adminEmail:"facundo@example.com"})});if(s.ok)c(o.filter(s=>s.id!==e)),d===e&&(x(null),h([])),alert("Usuario eliminado correctamente.");else{let e=await s.json();alert("Error al eliminar: "+(e.error||"Desconocido"))}}catch(e){console.error("Error deleting user:",e),alert("Error al procesar la solicitud.")}};return i?(0,s.jsx)("div",{className:"text-white p-10",children:"Cargando..."}):(0,s.jsx)("div",{className:"min-h-screen bg-slate-900 text-slate-100 p-8",children:(0,s.jsxs)("div",{className:"max-w-6xl mx-auto",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-8",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-purple-400",children:"Panel de Administración"}),(0,s.jsxs)("div",{className:"flex gap-4",children:[(0,s.jsxs)("div",{className:"flex bg-slate-800 rounded-lg p-1",children:[(0,s.jsx)("button",{onClick:()=>g("users"),className:`px-4 py-2 rounded-md transition-colors ${"users"===j?"bg-purple-600 text-white":"text-slate-400 hover:text-white"}`,children:"Usuarios"}),(0,s.jsx)("button",{onClick:()=>g("logs"),className:`px-4 py-2 rounded-md transition-colors ${"logs"===j?"bg-purple-600 text-white":"text-slate-400 hover:text-white"}`,children:"Logs de Errores"})]}),(0,s.jsx)("button",{onClick:()=>n.push("/"),className:"text-slate-400 hover:text-white px-4 py-2",children:"Volver al Inicio"})]})]}),"users"===j?(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[(0,s.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 border border-slate-700 h-fit",children:[(0,s.jsx)("h2",{className:"text-xl font-bold mb-4 text-white",children:"Emprendimientos"}),(0,s.jsxs)("div",{className:"space-y-2",children:[o.map(e=>(0,s.jsxs)("div",{className:"flex gap-2 group",children:[(0,s.jsxs)("button",{onClick:()=>w(e.id),className:`flex-1 text-left p-3 rounded-lg transition-colors ${d===e.id?"bg-purple-600 text-white":"bg-slate-700/50 text-slate-300 hover:bg-slate-700"}`,children:[(0,s.jsx)("div",{className:"font-bold",children:e.business_name}),(0,s.jsx)("div",{className:"text-xs opacity-70",children:e.email})]}),(0,s.jsx)("button",{onClick:()=>y(e.id,e.business_name),className:"p-3 bg-red-900/20 text-red-400 rounded-lg hover:bg-red-600 hover:text-white transition-colors opacity-0 group-hover:opacity-100",title:"Eliminar usuario",children:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0"})})})]},e.id)),0===o.length&&(0,s.jsx)("p",{className:"text-slate-500 text-sm",children:"No hay perfiles visibles aún."})]})]}),(0,s.jsx)("div",{className:"md:col-span-2 bg-slate-800 rounded-xl p-6 border border-slate-700 min-h-[500px]",children:d?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("h2",{className:"text-2xl font-bold mb-6 text-white",children:["Turnos de ",o.find(e=>e.id===d)?.business_name]}),p?(0,s.jsx)("p",{children:"Cargando datos..."}):(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"w-full text-left border-collapse",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{className:"border-b border-slate-700 text-slate-400 text-sm",children:[(0,s.jsx)("th",{className:"p-3",children:"Fecha"}),(0,s.jsx)("th",{className:"p-3",children:"Cliente"}),(0,s.jsx)("th",{className:"p-3",children:"Tarea"}),(0,s.jsx)("th",{className:"p-3 text-right",children:"Precio"}),(0,s.jsx)("th",{className:"p-3 text-center",children:"Estado"})]})}),(0,s.jsxs)("tbody",{className:"divide-y divide-slate-700/50",children:[m.map(e=>(0,s.jsxs)("tr",{className:"hover:bg-slate-700/30",children:[(0,s.jsxs)("td",{className:"p-3 text-slate-300",children:[new Date(e.date_time).toLocaleDateString()," ",(0,s.jsx)("br",{}),(0,s.jsx)("span",{className:"text-xs text-slate-500",children:new Date(e.date_time).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),(0,s.jsx)("td",{className:"p-3 font-medium text-white",children:e.client_name}),(0,s.jsx)("td",{className:"p-3 text-slate-300",children:e.task}),(0,s.jsxs)("td",{className:"p-3 text-right font-mono text-green-400",children:["$",e.estimated_price]}),(0,s.jsx)("td",{className:"p-3 text-center",children:e.completed?(0,s.jsx)("span",{className:"px-2 py-1 bg-green-900/50 text-green-400 rounded text-xs",children:"Completado"}):(0,s.jsx)("span",{className:"px-2 py-1 bg-yellow-900/50 text-yellow-400 rounded text-xs",children:"Pendiente"})})]},e.id)),0===m.length&&(0,s.jsx)("tr",{children:(0,s.jsx)("td",{colSpan:5,className:"p-8 text-center text-slate-500",children:"Este usuario no tiene turnos registrados."})})]})]})})]}):(0,s.jsxs)("div",{className:"h-full flex flex-col items-center justify-center text-slate-500",children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-16 h-16 mb-4 opacity-50",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 19.128a9.38 9.38 0 002.625.372 9.337 9.337 0 004.121-.952 4.125 4.125 0 00-7.533-2.493M15 19.128v-.003c0-1.113-.285-2.16-.786-3.07M15 19.128v.106A12.318 12.318 0 018.624 21c-2.331 0-4.512-.645-6.374-1.766l-.001-.109a6.375 6.375 0 0111.964-3.07M12 6.375a3.375 3.375 0 11-6.75 0 3.375 3.375 0 016.75 0zm8.25 2.25a2.625 2.625 0 11-5.25 0 2.625 2.625 0 015.25 0z"})}),(0,s.jsx)("p",{children:"Selecciona un emprendimiento para ver sus detalles"})]})})]}):(0,s.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6 border border-slate-700",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,s.jsx)("h2",{className:"text-xl font-bold text-white",children:"Registro de Errores (Logs)"}),(0,s.jsx)("button",{onClick:v,className:"text-sm text-purple-400 hover:text-purple-300",children:"Actualizar"})]}),(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"w-full text-left border-collapse",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{className:"border-b border-slate-700 text-slate-400 text-sm",children:[(0,s.jsx)("th",{className:"p-3",children:"Fecha"}),(0,s.jsx)("th",{className:"p-3",children:"Usuario/Negocio"}),(0,s.jsx)("th",{className:"p-3",children:"Contexto"}),(0,s.jsx)("th",{className:"p-3",children:"Error"})]})}),(0,s.jsxs)("tbody",{className:"divide-y divide-slate-700/50",children:[N.map(e=>(0,s.jsxs)("tr",{className:"hover:bg-slate-700/30 text-sm",children:[(0,s.jsx)("td",{className:"p-3 text-slate-400 whitespace-nowrap",children:new Date(e.created_at).toLocaleString()}),(0,s.jsx)("td",{className:"p-3 text-white font-medium",children:e.business_name}),(0,s.jsx)("td",{className:"p-3 text-purple-400",children:e.context}),(0,s.jsx)("td",{className:"p-3 text-red-300 font-mono text-xs",children:e.error_message})]},e.id)),0===N.length&&(0,s.jsx)("tr",{children:(0,s.jsx)("td",{colSpan:4,className:"p-8 text-center text-slate-500",children:"No hay errores registrados."})})]})]})})]})]})})}e.s(["default",()=>i])}]);